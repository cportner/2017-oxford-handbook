ivNone <-
ivreg(lwelfare ~ attend + age + female
+ hhsize + num.adults
| . - attend  + com.market + com.hospital + land.own + land.rent ,
subset = edu.none == "1",
data = litData
)
summary(ivNone)
ivNone2 <-
ivreg(lwelfare ~ attend + age + female
+ hhsize + num.adults
| . - attend + com.hospital + com.road + land.own + land.rent ,
subset = edu.none == "1",
data = litData
)
summary(ivNone2)
# IV for everybody, no education only
ivNone <-
ivreg(lwelfare ~ attend + age + female
+ hhsize + num.adults
| . - attend  + com.market + com.hospital + com.road + land.own + land.rent ,
subset = edu.none == "1",
data = litData
)
summary(ivNone)
# IV for everybody, no education only - different instruments
ivNone2 <-
ivreg(lwelfare ~ attend + age + female
+ hhsize + num.adults
| . - attend + com.hospital + com.road + land.own + land.rent ,
subset = edu.none == "1",
data = litData
)
summary(ivNone2)
`14_Dec_08_58_Grades.ECON_4770_01` <- read.csv("~/Downloads/14_Dec_08_58_Grades-ECON_4770_01.csv")
View(`14_Dec_08_58_Grades.ECON_4770_01`)
LPGA <- read.csv("~/teaching/econ3100/2017-01/misc/LPGA.csv")
View(LPGA)
summary(LPGA$scoring.avg)
sd(LPGA$scoring.avg)
mean(LPGA)
mean(LPGA$earnings.usd)
with(LPGA, mean(scoring.avg))
with(LPGA, mean(scoring.avg), sd(scoring.avg))
with(LPGA, mean(scoring.avg) sd(scoring.avg))
summary(LPGA)
sapply(LPGA, sd)
auto <- load(https://dl.dropboxusercontent.com/u/29793394/autos.RData)
auto <- load("https://dl.dropboxusercontent.com/u/29793394/autos.RData")
auto <- url("https://dl.dropboxusercontent.com/u/29793394/autos.RData")
auto <- load("https://dl.dropboxusercontent.com/u/29793394/autos.RData")
library(stargazer)
stargazer(snap)
snap <- url("https://dl.dropboxusercontent.com/u/29793394/econ3100_ps4.rdata")
snap <- load(url("https://dl.dropboxusercontent.com/u/29793394/econ3100_ps4.rdata"))
snap <- load(url("https://dl.dropboxusercontent.com/u/29793394/econ3100_ps4.rdata"))
auto <- url(â€œhttps://dl.dropboxusercontent.com/u/29793394/ autos.RData")
auto <- url("https://dl.dropboxusercontent.com/u/29793394/ autos.RData")
auto <- load(url("https://dl.dropboxusercontent.com/u/29793394/ autos.RData"))
auto <- load(url("https://dl.dropboxusercontent.com/u/29793394/autos.RData"))
snap <- Dataset
save(snap, file = "econ3100_ps4.RData")
load(url("https://dl.dropboxusercontent.com/u/29793394/econ3100_ps4.rdata"))
View(snap)
stargazer(snap)
stargazer(snap, type = "text")
regModel.1 <- lm(fsp.rate ~ unempr, data = snap)
summary(regModel.1)
coef(regModel.1$coefficients["(Intercept)"])
coef(summary(regModel.1)$coefficients["(Intercept)"])
coef(regModel.1)["(Intercept)"])
coef(regModel.1)["(Intercept)"]
coef(regModel.1)["(Intercept)"]+coef(regModel.1)["unempr"]*0.08
hist(rstandard(regModel.1), # normal distribution of errors?
xlab = "Standardized residuals")
plot(fitted(regModel.1), resid(regModel.1),
xlab = "Fitted", ylab = "Residuals",
abline(h=0, col="blue"))
# Graph for changes in TFR
# For Fertility Issues chapter in Oxford handbook
# Claus C Portner
# Begun.: 2017-02-10
# Edited: 2017-02-15
library(tidyr)
library(ggplot2)
library(directlabels) # don't really need this
# Variable definitions
# SP.DYN.TFRT.IN	Fertility rate, total (births per woman)
# SP.DYN.WFRT	    Wanted fertility rate (births per woman)
# SP.ADO.TFRT	    Adolescent fertility rate (births per 1,000 women ages 15-19)
# SH.DYN.MORT	    Mortality rate, under-5 (per 1,000 live births)
# SH.DYN.MORT.FE	Mortality rate, under-5, female (per 1,000 live births)
# SH.DYN.MORT.MA	Mortality rate, under-5, male (per 1,000 live births)
# Country codes
# Latin America & the Caribbean (IDA & IBRD countries)	TLA
# Middle East & North Africa (IDA & IBRD countries)	TMN
# IDA & IBRD total	IBT
# Europe & Central Asia (IDA & IBRD countries)	TEC
# East Asia & Pacific (IDA & IBRD countries)	TEA
# South Asia (IDA & IBRD)	TSA
# Sub-Saharan Africa (IDA & IBRD countries)	TSS
# short file paths - assuming work directory is "code"
dataDir <- "../data/Data_Extract_From_World_Development_Indicators"
figureDir <- "../figures"
# Data - extracted from World Bank WDI 2017-02-09 - need to reshape
# .. is missing in the original data
df <- read.csv(
file.path(dataDir,"2017-02-09-wdi-extract.csv"),
na.strings=c(".."))
df$Country.Name <- NULL
df$Series.Name <- NULL
# Tidying up data (need tidyr for that) - multistep process
test <- gather(df, key, value, -Country.Code, -Series.Code)
test1 <- separate(test, key, into = c("y1","y2"), sep = 1)
test2 <- separate(test1, y2, into = c("year","x2"), sep = 4)
test2$y1 <- NULL
test2$x2 <- NULL
test3 <- spread(test2, Series.Code, value)
df <- test3
df$year <- as.numeric(df$year)
df$SH.DYN.MORT <- as.numeric(df$SH.DYN.MORT)
df$SH.DYN.MORT.FE <- as.numeric(df$SH.DYN.MORT.FE)
df$SH.DYN.MORT.MA <- as.numeric(df$SH.DYN.MORT.MA)
df$SP.ADO.TFRT <- as.numeric(df$SP.ADO.TFRT)
df$SP.DYN.TFRT.IN <- as.numeric(df$SP.DYN.TFRT.IN)
df$SP.DYN.WFRT <- as.numeric(df$SP.DYN.WFRT)
# Graph for TFR
p <- ggplot(data = df, aes(x=year, y=SP.DYN.TFRT.IN, fill  = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
scale_y_continuous(expand = c(0, 0), limits = c(0,8)) + # better way of 0 in TFR
xlab("Year") + ylab("Total Fertility Rate") + # Pretty labels
ggtitle("Changes in Total Fertility Rate by Region - 1967-2015") +
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.25, .15))
p + geom_hline(aes(yintercept = 2.1), linetype = "dashed", colour = "red") # pretty line for replacement fertility
p
setwd("~/projects/chapters/2017-oxford-handbook")
# Graph for changes in TFR
# For Fertility Issues chapter in Oxford handbook
# Claus C Portner
# Begun.: 2017-02-10
# Edited: 2017-02-15
library(tidyr)
library(ggplot2)
library(directlabels) # don't really need this
# Variable definitions
# SP.DYN.TFRT.IN	Fertility rate, total (births per woman)
# SP.DYN.WFRT	    Wanted fertility rate (births per woman)
# SP.ADO.TFRT	    Adolescent fertility rate (births per 1,000 women ages 15-19)
# SH.DYN.MORT	    Mortality rate, under-5 (per 1,000 live births)
# SH.DYN.MORT.FE	Mortality rate, under-5, female (per 1,000 live births)
# SH.DYN.MORT.MA	Mortality rate, under-5, male (per 1,000 live births)
# Country codes
# Latin America & the Caribbean (IDA & IBRD countries)	TLA
# Middle East & North Africa (IDA & IBRD countries)	TMN
# IDA & IBRD total	IBT
# Europe & Central Asia (IDA & IBRD countries)	TEC
# East Asia & Pacific (IDA & IBRD countries)	TEA
# South Asia (IDA & IBRD)	TSA
# Sub-Saharan Africa (IDA & IBRD countries)	TSS
# short file paths - assuming work directory is "code"
dataDir <- "../data/Data_Extract_From_World_Development_Indicators"
figureDir <- "../figures"
# Data - extracted from World Bank WDI 2017-02-09 - need to reshape
# .. is missing in the original data
df <- read.csv(
file.path(dataDir,"2017-02-09-wdi-extract.csv"),
na.strings=c(".."))
df$Country.Name <- NULL
df$Series.Name <- NULL
# Tidying up data (need tidyr for that) - multistep process
test <- gather(df, key, value, -Country.Code, -Series.Code)
test1 <- separate(test, key, into = c("y1","y2"), sep = 1)
test2 <- separate(test1, y2, into = c("year","x2"), sep = 4)
test2$y1 <- NULL
test2$x2 <- NULL
test3 <- spread(test2, Series.Code, value)
df <- test3
df$year <- as.numeric(df$year)
df$SH.DYN.MORT <- as.numeric(df$SH.DYN.MORT)
df$SH.DYN.MORT.FE <- as.numeric(df$SH.DYN.MORT.FE)
df$SH.DYN.MORT.MA <- as.numeric(df$SH.DYN.MORT.MA)
df$SP.ADO.TFRT <- as.numeric(df$SP.ADO.TFRT)
df$SP.DYN.TFRT.IN <- as.numeric(df$SP.DYN.TFRT.IN)
df$SP.DYN.WFRT <- as.numeric(df$SP.DYN.WFRT)
# Graph for TFR
p <- ggplot(data = df, aes(x=year, y=SP.DYN.TFRT.IN, fill  = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
scale_y_continuous(expand = c(0, 0), limits = c(0,8)) + # better way of 0 in TFR
xlab("Year") + ylab("Total Fertility Rate") + # Pretty labels
ggtitle("Changes in Total Fertility Rate by Region - 1967-2015") +
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.25, .15))
p + geom_hline(aes(yintercept = 2.1), linetype = "dashed", colour = "red") # pretty line for replacement fertility
p
setwd("~/projects/chapters/2017-oxford-handbook/code")
# Graph for changes in TFR
# For Fertility Issues chapter in Oxford handbook
# Claus C Portner
# Begun.: 2017-02-10
# Edited: 2017-02-15
library(tidyr)
library(ggplot2)
library(directlabels) # don't really need this
# Variable definitions
# SP.DYN.TFRT.IN	Fertility rate, total (births per woman)
# SP.DYN.WFRT	    Wanted fertility rate (births per woman)
# SP.ADO.TFRT	    Adolescent fertility rate (births per 1,000 women ages 15-19)
# SH.DYN.MORT	    Mortality rate, under-5 (per 1,000 live births)
# SH.DYN.MORT.FE	Mortality rate, under-5, female (per 1,000 live births)
# SH.DYN.MORT.MA	Mortality rate, under-5, male (per 1,000 live births)
# Country codes
# Latin America & the Caribbean (IDA & IBRD countries)	TLA
# Middle East & North Africa (IDA & IBRD countries)	TMN
# IDA & IBRD total	IBT
# Europe & Central Asia (IDA & IBRD countries)	TEC
# East Asia & Pacific (IDA & IBRD countries)	TEA
# South Asia (IDA & IBRD)	TSA
# Sub-Saharan Africa (IDA & IBRD countries)	TSS
# short file paths - assuming work directory is "code"
dataDir <- "../data/Data_Extract_From_World_Development_Indicators"
figureDir <- "../figures"
# Data - extracted from World Bank WDI 2017-02-09 - need to reshape
# .. is missing in the original data
df <- read.csv(
file.path(dataDir,"2017-02-09-wdi-extract.csv"),
na.strings=c(".."))
df$Country.Name <- NULL
df$Series.Name <- NULL
# Tidying up data (need tidyr for that) - multistep process
test <- gather(df, key, value, -Country.Code, -Series.Code)
test1 <- separate(test, key, into = c("y1","y2"), sep = 1)
test2 <- separate(test1, y2, into = c("year","x2"), sep = 4)
test2$y1 <- NULL
test2$x2 <- NULL
test3 <- spread(test2, Series.Code, value)
df <- test3
df$year <- as.numeric(df$year)
df$SH.DYN.MORT <- as.numeric(df$SH.DYN.MORT)
df$SH.DYN.MORT.FE <- as.numeric(df$SH.DYN.MORT.FE)
df$SH.DYN.MORT.MA <- as.numeric(df$SH.DYN.MORT.MA)
df$SP.ADO.TFRT <- as.numeric(df$SP.ADO.TFRT)
df$SP.DYN.TFRT.IN <- as.numeric(df$SP.DYN.TFRT.IN)
df$SP.DYN.WFRT <- as.numeric(df$SP.DYN.WFRT)
# Graph for TFR
p <- ggplot(data = df, aes(x=year, y=SP.DYN.TFRT.IN, fill  = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
scale_y_continuous(expand = c(0, 0), limits = c(0,8)) + # better way of 0 in TFR
xlab("Year") + ylab("Total Fertility Rate") + # Pretty labels
ggtitle("Changes in Total Fertility Rate by Region - 1967-2015") +
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.25, .15))
p + geom_hline(aes(yintercept = 2.1), linetype = "dashed", colour = "red") # pretty line for replacement fertility
p
mortalityPlot <- ggplot(data = df, aes(x=year, y=SP.DYN.MORT, fill = Country.Code, color = Country.Code))
mortalityPlot
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code))
mortalityPlot
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT))
mortalityPlot
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code))
mortalityPlot
mortalityPlot + geom_line()
mortalityPlot + geom_line(size=1.5)
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
scale_y_continuous(expand = c(0, 0), limits = c(0,8)) + # better way of 0 in TFR
xlab("Year") + ylab("Mortality Rate, Under-5 (per 1,000 live births)") + # Pretty labels
ggtitle("Changes in Child Mortality Rate by Region - 1967-2015") +
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.25, .15))
mortalityPlot
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
xlab("Year") + ylab("Mortality Rate, Under-5 (per 1,000 live births)") + # Pretty labels
ggtitle("Changes in Child Mortality Rate by Region - 1967-2015") +
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.25, .15))
mortalityPlot
mortalityPlot + scale_y_continuous(expand = c(0, 0), limits = c(0,275)) + # better way of 0 in TFR
stop()
mortalityPlot
mortalityPlot + scale_y_continuous(expand = c(0, 0), limits = c(0,275))
mortalityPlot +   theme(legend.position = c(.25, .75))
mortalityPlot +   theme(legend.position = c(.75, .8))
mortalityPlot +   theme(legend.position = c(.8, .8))
mortalityPlot +   theme(legend.position = c(.75, .8))
mortalityPlot +   theme(legend.position = c(.75, .85))
mortalityPlot +   theme(legend.position = c(.75, .83))
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
xlab("Year") + ylab("Mortality Rate, Under-5 (per 1,000 live births)") + # Pretty labels
ggtitle("Changes in Child Mortality Rate by Region - 1967-2015") +
scale_y_continuous(expand = c(0, 0), limits = c(0,275)) + # better way of 0 in TFR
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.75, .83))
mortalityPlot
mortalityPlot + scale_color_continuous(breaks = c(50,100,150,200,250))
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
xlab("Year") + ylab("Mortality Rate, Under-5 (per 1,000 live births)") + # Pretty labels
ggtitle("Changes in Child Mortality Rate by Region - 1967-2015") +
scale_y_continuous(expand = c(0, 0), limits = c(0,275)) + # better way of 0 in TFR
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.75, .83))
mortalityPlot
mortalityPlot + scale_y_continuous(breaks = c(50,100,150,200,250))
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
xlab("Year") + ylab("Mortality Rate, Under-5 (per 1,000 live births)") + # Pretty labels
ggtitle("Changes in Child Mortality Rate by Region - 1967-2015") +
scale_y_continuous(expand = c(0, 0), limits = c(0,275), breaks = c(50,100,150,200,250)) + # better way of 0 in TFR
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.75, .83))
mortalityPlot
# Graph for changes in TFR
# For Fertility Issues chapter in Oxford handbook
# Claus C Portner
# Begun.: 2017-02-10
# Edited: 2017-02-22
library(tidyr)
library(ggplot2)
library(directlabels) # don't really need this
# Variable definitions
# SP.DYN.TFRT.IN	Fertility rate, total (births per woman)
# SP.DYN.WFRT	    Wanted fertility rate (births per woman)
# SP.ADO.TFRT	    Adolescent fertility rate (births per 1,000 women ages 15-19)
# SH.DYN.MORT	    Mortality rate, under-5 (per 1,000 live births)
# SH.DYN.MORT.MA	Mortality rate, under-5, male (per 1,000 live births)
# SH.DYN.MORT.FE	Mortality rate, under-5, female (per 1,000 live births)
# Country codes
# Latin America & the Caribbean (IDA & IBRD countries)	TLA
# Middle East & North Africa (IDA & IBRD countries)	TMN
# IDA & IBRD total	IBT
# Europe & Central Asia (IDA & IBRD countries)	TEC
# East Asia & Pacific (IDA & IBRD countries)	TEA
# South Asia (IDA & IBRD)	TSA
# Sub-Saharan Africa (IDA & IBRD countries)	TSS
# short file paths - assuming work directory is "code"
dataDir <- "../data/Data_Extract_From_World_Development_Indicators"
figureDir <- "../figures"
# Data - extracted from World Bank WDI 2017-02-09 - need to reshape
# .. is missing in the original data
df <- read.csv(
file.path(dataDir,"2017-02-09-wdi-extract.csv"),
na.strings=c(".."))
df$Country.Name <- NULL
df$Series.Name <- NULL
# Tidying up data (need tidyr for that) - multistep process
test <- gather(df, key, value, -Country.Code, -Series.Code)
test1 <- separate(test, key, into = c("y1","y2"), sep = 1)
test2 <- separate(test1, y2, into = c("year","x2"), sep = 4)
test2$y1 <- NULL
test2$x2 <- NULL
test3 <- spread(test2, Series.Code, value)
df <- test3
df$year <- as.numeric(df$year)
df$SH.DYN.MORT <- as.numeric(df$SH.DYN.MORT)
df$SH.DYN.MORT.FE <- as.numeric(df$SH.DYN.MORT.FE)
df$SH.DYN.MORT.MA <- as.numeric(df$SH.DYN.MORT.MA)
df$SP.ADO.TFRT <- as.numeric(df$SP.ADO.TFRT)
df$SP.DYN.TFRT.IN <- as.numeric(df$SP.DYN.TFRT.IN)
df$SP.DYN.WFRT <- as.numeric(df$SP.DYN.WFRT)
# Graph for TFR
tfrPlot <- ggplot(data = df, aes(x=year, y=SP.DYN.TFRT.IN, fill  = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
scale_y_continuous(expand = c(0, 0), limits = c(0,8)) + # better way of 0 in TFR
xlab("Year") + ylab("Total Fertility Rate") + # Pretty labels
ggtitle("Changes in Total Fertility Rate by Region - 1967-2015") +
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.25, .15))
tfrPlot + geom_hline(aes(yintercept = 2.1), linetype = "dashed", colour = "red") # pretty line for replacement fertility
tfrPlot
ggsave(file.path(figureDir,"totalFertilityRates.pdf"), device = "pdf")
# Graph for mortality
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
xlab("Year") + ylab("Mortality Rate, Under-5 (per 1,000 live births)") + # Pretty labels
ggtitle("Changes in Child Mortality Rate by Region - 1967-2015") +
scale_y_continuous(expand = c(0, 0), limits = c(0,275), breaks = c(50,100,150,200,250)) + # better way of 0 in TFR
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.75, .83))
mortalityPlot
# Graph for changes in TFR
# For Fertility Issues chapter in Oxford handbook
# Claus C Portner
# Begun.: 2017-02-10
# Edited: 2017-02-22
library(tidyr)
library(ggplot2)
library(directlabels) # don't really need this
# Variable definitions
# SP.DYN.TFRT.IN	Fertility rate, total (births per woman)
# SP.DYN.WFRT	    Wanted fertility rate (births per woman)
# SP.ADO.TFRT	    Adolescent fertility rate (births per 1,000 women ages 15-19)
# SH.DYN.MORT	    Mortality rate, under-5 (per 1,000 live births)
# SH.DYN.MORT.MA	Mortality rate, under-5, male (per 1,000 live births)
# SH.DYN.MORT.FE	Mortality rate, under-5, female (per 1,000 live births)
# Country codes
# Latin America & the Caribbean (IDA & IBRD countries)	TLA
# Middle East & North Africa (IDA & IBRD countries)	TMN
# IDA & IBRD total	IBT
# Europe & Central Asia (IDA & IBRD countries)	TEC
# East Asia & Pacific (IDA & IBRD countries)	TEA
# South Asia (IDA & IBRD)	TSA
# Sub-Saharan Africa (IDA & IBRD countries)	TSS
# short file paths - assuming work directory is "code"
dataDir <- "../data/Data_Extract_From_World_Development_Indicators"
figureDir <- "../figures"
# Data - extracted from World Bank WDI 2017-02-09 - need to reshape
# .. is missing in the original data
df <- read.csv(
file.path(dataDir,"2017-02-09-wdi-extract.csv"),
na.strings=c(".."))
df$Country.Name <- NULL
df$Series.Name <- NULL
# Tidying up data (need tidyr for that) - multistep process
test <- gather(df, key, value, -Country.Code, -Series.Code)
test1 <- separate(test, key, into = c("y1","y2"), sep = 1)
test2 <- separate(test1, y2, into = c("year","x2"), sep = 4)
test2$y1 <- NULL
test2$x2 <- NULL
test3 <- spread(test2, Series.Code, value)
df <- test3
df$year <- as.numeric(df$year)
df$SH.DYN.MORT <- as.numeric(df$SH.DYN.MORT)
df$SH.DYN.MORT.FE <- as.numeric(df$SH.DYN.MORT.FE)
df$SH.DYN.MORT.MA <- as.numeric(df$SH.DYN.MORT.MA)
df$SP.ADO.TFRT <- as.numeric(df$SP.ADO.TFRT)
df$SP.DYN.TFRT.IN <- as.numeric(df$SP.DYN.TFRT.IN)
df$SP.DYN.WFRT <- as.numeric(df$SP.DYN.WFRT)
# Graph for TFR
tfrPlot <- ggplot(data = df, aes(x=year, y=SP.DYN.TFRT.IN, fill  = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
scale_y_continuous(expand = c(0, 0), limits = c(0,8)) + # better way of 0 in TFR
xlab("Year") + ylab("Total Fertility Rate") + # Pretty labels
ggtitle("Changes in Total Fertility Rate by Region - 1967-2015") +
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.25, .15))
tfrPlot + geom_hline(aes(yintercept = 2.1), linetype = "dashed", colour = "red") # pretty line for replacement fertility
tfrPlot
ggsave(file.path(figureDir,"totalFertilityRates.pdf"), device = "pdf")
# Graph for mortality
mortalityPlot <- ggplot(data = df, aes(x=year, y=SH.DYN.MORT, fill = Country.Code, color = Country.Code)) +
geom_line(size=1.5) + # Thicker line
xlab("Year") + ylab("Mortality Rate, Under-5 (per 1,000 live births)") + # Pretty labels
ggtitle("Changes in Child Mortality Rate by Region - 1967-2015") +
scale_y_continuous(expand = c(0, 0), limits = c(0,275), breaks = c(50,100,150,200,250)) + # better way of 0 in TFR
scale_colour_discrete(name = "Regions",
labels = c("Overall", "East Asia & Pacific", "Europe & Central Asia",
"Latin America & the Caribbean", "Middle East & North Africa",
"South Asia", "Sub-Saharan Africa" )) +
guides(color = guide_legend(ncol = 2)) +
theme_bw() +
theme(legend.position = c(.75, .83))
mortalityPlot
ggsave(file.path(figureDir,"childMortalityRates.pdf"), device = "pdf")
